/*!
	Video plugin for Shower, HTML presentation engine (github.com/shower/shower)

	Browser support: latest versions of all major browsers

	@url github.com/operatino/shower-video
	@author Robert Haritonov <r@rhr.me>
	@twitter @operatino
*/
window.showerVideo&&window.showerVideo.init||(window.showerVideo=function(a,b,c){var d={},e={},f=b.getElementsByTagName("html")[0],g=0;return d.debug=!1,d.isMobile=!1,d.isIPhone=!1,d.isIPad=!1,e.query=function(a){return b.querySelectorAll(a)},e.forEach=function(a,b){Array.prototype.forEach.call(a,function(a){b(a)})},d.prepareEnv=function(){(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(d.isMobile=!0,f.classList.add("mobile")),navigator.userAgent.match(/iPhone/i)&&(d.isIPhone=!0,f.classList.add("iphone")),navigator.userAgent.match(/iPad/i)&&(d.isIPad=!0,f.classList.add("ipad"))},d.startVideo=function(){var a=e.query("video");e.forEach(a,function(a){a.pause(),d.isMobile&&(a.parentNode.style.display="none")});var b=e.query(".slide.active video");e.forEach(b,function(a){var b=function(){a.currentTime=0,a.play()},e=function(){a.load(),a.play(),a.pause(),a.addEventListener("canplaythrough",b,!1)};a&&a.currentTime!==c&&(4!==a.readyState?(d.debug&&console.log("Video not ready"),d.isMobile&&0===g?setTimeout(function(){g=1,a.parentNode.style.display="block",e()},700):(d.isMobile&&(a.parentNode.style.display="block"),e())):(d.debug&&console.log("Video is ready"),d.isMobile&&(a.parentNode.style.display="block"),b()))})},d.startGif=function(){var a=e.query(".slide.active .gif"),b=e.query(".slide .gif");0!==a.length?e.forEach(a,function(a){a.style.display=a.classList.contains("real")?"block":"none"}):e.forEach(b,function(a){a.style.display=a.classList.contains("real")?"none":"block"})},d.init=function(){d.prepareEnv(),b.addEventListener("switchSlide",function(){d.startVideo(),d.startGif()},!1)},d.init(),d}(this,this.document));